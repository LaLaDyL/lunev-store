const API_BASE = window.location.origin;
// header.js - –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±—ç–∫–µ–Ω–¥–æ–º
document.addEventListener('DOMContentLoaded', async () => {
  const nav = document.querySelector('.nav');
  if (!nav) return;

  const loginLink = nav.querySelector('.login-link');
  const loggedIn = localStorage.getItem('loggedIn') === 'true';
  const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');

  if (loggedIn && currentUser) {
    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é —Å—Å—ã–ª–∫—É "–í–æ–π—Ç–∏"
    if (loginLink) {
      loginLink.remove();
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å–æ–∑–¥–∞–Ω–æ –ª–∏ —É–∂–µ –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if (nav.querySelector('.user-menu')) {
      return;
    }

    // –°–æ–∑–¥–∞–µ–º –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const userMenu = document.createElement('div');
    userMenu.className = 'user-menu';
    userMenu.style.position = 'relative';
    userMenu.style.display = 'inline-block';

    userMenu.innerHTML = `
      <a href="profile.html" class="user-profile-link" style="
        color: white;
        text-decoration: none;
        font-size: 16px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        border-radius: 20px;
        background: rgba(255,255,255,0.2);
        transition: background 0.3s;
      ">
        üë§ ${currentUser.firstName || '–ü—Ä–æ—Ñ–∏–ª—å'}
      </a>
    `;

    // –î–æ–±–∞–≤–ª—è–µ–º –º–µ–Ω—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏—é
    nav.appendChild(userMenu);

    // –î–æ–±–∞–≤–ª—è–µ–º hover —ç—Ñ—Ñ–µ–∫—Ç
    const profileLink = userMenu.querySelector('.user-profile-link');
    profileLink.addEventListener('mouseenter', () => {
      profileLink.style.background = 'rgba(255,255,255,0.3)';
    });
    profileLink.addEventListener('mouseleave', () => {
      profileLink.style.background = 'rgba(255,255,255,0.2)';
    });
  }
});